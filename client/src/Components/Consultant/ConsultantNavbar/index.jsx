import React, { useState } from "react";
import Popup from 'reactjs-popup'
import { useNavigate, Link } from "react-router-dom";
import { RxHamburgerMenu } from "react-icons/rx";
import { IoIosSearch } from "react-icons/io";
import { FaArrowLeft } from "react-icons/fa";
import { IoClose } from "react-icons/io5";
import "./index.css";
import { IoMdMore } from "react-icons/io";
import './index.css';
import { useAuth } from "../../../Context/Auth1"; 

const ConsultantNavbar = () => {
  const [auth, setAuth] = useAuth();
  const [searchInput, setSearchValue] = useState("");
  const [onClickHambergicon, setOnClickHambergicon] = useState(false);
  const [onClickSearchIcon, setOnclickSearchIcon] = useState(false);
  const navigate = useNavigate();
  const menuIcon = onClickHambergicon ? <IoClose/> : <RxHamburgerMenu/>;
  const handleLogout = () => {
    try {
      // Remove the auth token from localStorage
      localStorage.removeItem('consultantAuth');
  
      // Clear the auth state
      setAuth({
        user: auth.user,
        consultant: null,
        token: ""
      });
  
      // Navigate to the consultant signin page
      navigate('/consultant/signin');
    } catch (error) {
      console.error('Logout error:', error);
      // Handle any unexpected errors (e.g., show error message to user)
    }
  };

  return (
    <>
      <div className="navbar max-devices">
        <div className="left-content-logo">
          <img onClick={()=>navigate('/consultant/home-page')} src='https://res.cloudinary.com/dgl0v7vwf/image/upload/v1719508464/Plato_Logo-F_lu8fzv.png' alt="plato-kart" style={{height:"100px",width:"100px",borderRadius:"50%"}} />
        </div>
        <div className="navbar-contents-container">
          <Link className="nav-link" to="/consultant/aboutus">
            <p className="navbar-content-menu">About Platokart</p>
          </Link>
          <Link className="nav-link" to="/community-panel">
            <p className="navbar-content-menu">Community</p>
          </Link>
          <Link className="nav-link" to="/consultant/contactus">
            <p className="navbar-content-menu">Just Ask</p>
          </Link>
          
          <Popup
                trigger={
                  <button className="consultant-navbar-more-btn"><IoMdMore/></button>
                }
                position="bottom right"
              >
                <div className="popup-body">
                  <li className="popup-list-item" onClick={()=>navigate('/setting')}>
                  <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 32 32" fill="none">
                    <path d="M28.426 12.7333L25.906 11.8933L27.0927 9.51996C27.213 9.27154 27.2532 8.99192 27.2078 8.71966C27.1625 8.4474 27.0337 8.19594 26.8394 7.99996L23.9994 5.15996C23.8023 4.96274 23.5485 4.83224 23.2734 4.7868C22.9984 4.74136 22.716 4.78326 22.466 4.90663L20.0927 6.0933L19.2527 3.5733C19.164 3.31062 18.9956 3.08213 18.7709 2.91963C18.5463 2.75712 18.2766 2.66869 17.9994 2.66663H13.9994C13.7198 2.66591 13.4471 2.75306 13.2198 2.91575C12.9925 3.07845 12.8221 3.30847 12.7327 3.5733L11.8927 6.0933L9.51935 4.90663C9.27093 4.78634 8.99131 4.7461 8.71905 4.79148C8.44679 4.83685 8.19533 4.9656 7.99935 5.15996L5.15935 7.99996C4.96213 8.19698 4.83163 8.45086 4.78619 8.7259C4.74075 9.00094 4.78265 9.28331 4.90602 9.5333L6.09269 11.9066L3.57269 12.7466C3.31001 12.8353 3.08152 13.0037 2.91902 13.2284C2.75651 13.453 2.66808 13.7227 2.66602 14V18C2.6653 18.2795 2.75245 18.5522 2.91514 18.7795C3.07784 19.0068 3.30786 19.1772 3.57269 19.2666L6.09269 20.1066L4.90602 22.48C4.78573 22.7284 4.74549 23.008 4.79087 23.2803C4.83624 23.5525 4.96499 23.804 5.15935 24L7.99935 26.84C8.19637 27.0372 8.45025 27.1677 8.72529 27.2131C9.00033 27.2586 9.2827 27.2167 9.53269 27.0933L11.906 25.9066L12.746 28.4266C12.8355 28.6915 13.0059 28.9215 13.2332 29.0842C13.4605 29.2469 13.7332 29.334 14.0127 29.3333H18.0127C18.2922 29.334 18.5649 29.2469 18.7922 29.0842C19.0195 28.9215 19.1899 28.6915 19.2794 28.4266L20.1194 25.9066L22.4927 27.0933C22.7395 27.2106 23.0164 27.2491 23.2859 27.2038C23.5554 27.1585 23.8044 27.0315 23.9994 26.84L26.8394 24C27.0366 23.8029 27.1671 23.5491 27.2125 23.274C27.258 22.999 27.2161 22.7166 27.0927 22.4666L25.906 20.0933L28.426 19.2533C28.6887 19.1646 28.9172 18.9962 29.0797 18.7716C29.2422 18.5469 29.3306 18.2772 29.3327 18V14C29.3334 13.7204 29.2463 13.4478 29.0836 13.2205C28.9209 12.9932 28.6908 12.8227 28.426 12.7333ZM26.666 17.04L25.066 17.5733C24.6981 17.6926 24.3605 17.8906 24.0768 18.1534C23.793 18.4163 23.5698 18.7377 23.4226 19.0954C23.2755 19.4531 23.2079 19.8386 23.2246 20.225C23.2413 20.6114 23.3419 20.9896 23.5194 21.3333L24.2794 22.8533L22.8127 24.32L21.3327 23.52C20.9908 23.3496 20.6162 23.2547 20.2344 23.2417C19.8526 23.2287 19.4725 23.2978 19.1198 23.4445C18.767 23.5911 18.4499 23.8119 18.1899 24.0917C17.9299 24.3716 17.733 24.7041 17.6127 25.0666L17.0794 26.6666H14.9594L14.426 25.0666C14.3067 24.6987 14.1087 24.3611 13.8459 24.0774C13.583 23.7936 13.2616 23.5704 12.9039 23.4232C12.5462 23.2761 12.1608 23.2085 11.7743 23.2252C11.3879 23.2419 11.0097 23.3425 10.666 23.52L9.14602 24.28L7.67935 22.8133L8.47935 21.3333C8.65681 20.9896 8.75738 20.6114 8.77408 20.225C8.79078 19.8386 8.72322 19.4531 8.57607 19.0954C8.42893 18.7377 8.20572 18.4163 7.92195 18.1534C7.63817 17.8906 7.30061 17.6926 6.93269 17.5733L5.33269 17.04V14.96L6.93269 14.4266C7.30061 14.3073 7.63817 14.1093 7.92195 13.8465C8.20572 13.5837 8.42893 13.2622 8.57607 12.9045C8.72322 12.5468 8.79078 12.1614 8.77408 11.7749C8.75738 11.3885 8.65681 11.0103 8.47935 10.6666L7.71935 9.18663L9.18602 7.71996L10.666 8.47996C11.0097 8.65742 11.3879 8.75799 11.7743 8.77469C12.1608 8.79139 12.5462 8.72383 12.9039 8.57668C13.2616 8.42954 13.583 8.20633 13.8459 7.92256C14.1087 7.63878 14.3067 7.30122 14.426 6.9333L14.9594 5.3333H17.0394L17.5727 6.9333C17.692 7.30122 17.89 7.63878 18.1528 7.92256C18.4157 8.20633 18.7371 8.42954 19.0948 8.57668C19.4525 8.72383 19.8379 8.79139 20.2244 8.77469C20.6108 8.75799 20.989 8.65742 21.3327 8.47996L22.8527 7.71996L24.3194 9.18663L23.5194 10.6666C23.349 11.0086 23.2541 11.3831 23.2411 11.7649C23.2281 12.1467 23.2972 12.5268 23.4439 12.8795C23.5905 13.2323 23.8113 13.5494 24.0911 13.8094C24.371 14.0694 24.7035 14.2663 25.066 14.3866L26.666 14.92V17.04ZM15.9994 10.6666C14.9445 10.6666 13.9134 10.9794 13.0363 11.5655C12.1593 12.1515 11.4757 12.9844 11.072 13.959C10.6683 14.9335 10.5627 16.0059 10.7685 17.0404C10.9743 18.075 11.4822 19.0253 12.2281 19.7712C12.974 20.5171 13.9243 21.025 14.9589 21.2308C15.9934 21.4366 17.0658 21.331 18.0403 20.9273C19.0149 20.5237 19.8478 19.8401 20.4339 18.963C21.0199 18.0859 21.3327 17.0548 21.3327 16C21.3327 14.5855 20.7708 13.2289 19.7706 12.2287C18.7704 11.2285 17.4138 10.6666 15.9994 10.6666ZM15.9994 18.6666C15.4719 18.6666 14.9564 18.5102 14.5178 18.2172C14.0793 17.9242 13.7375 17.5077 13.5357 17.0205C13.3338 16.5332 13.281 15.997 13.3839 15.4797C13.4868 14.9624 13.7408 14.4873 14.1137 14.1143C14.4867 13.7414 14.9618 13.4874 15.4791 13.3845C15.9964 13.2816 16.5326 13.3344 17.0198 13.5363C17.5071 13.7381 17.9236 14.0799 18.2166 14.5184C18.5096 14.957 18.666 15.4725 18.666 16C18.666 16.7072 18.3851 17.3855 17.885 17.8856C17.3849 18.3857 16.7066 18.6666 15.9994 18.6666Z" fill="black"/>
                  </svg>
                    <p className="popup-list-content">Settings</p>
                  </li>
                  <li className="popup-list-item" onClick={handleLogout}>
                  <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 32 32" fill="none">
                  <path d="M5.33398 16C5.33398 16.3536 5.47446 16.6927 5.72451 16.9428C5.97456 17.1928 6.3137 17.3333 6.66732 17.3333H16.7873L13.7207 20.3866C13.5957 20.5106 13.4965 20.658 13.4288 20.8205C13.3611 20.983 13.3263 21.1573 13.3263 21.3333C13.3263 21.5093 13.3611 21.6836 13.4288 21.8461C13.4965 22.0085 13.5957 22.156 13.7207 22.28C13.8446 22.4049 13.9921 22.5041 14.1545 22.5718C14.317 22.6395 14.4913 22.6744 14.6673 22.6744C14.8433 22.6744 15.0176 22.6395 15.1801 22.5718C15.3426 22.5041 15.49 22.4049 15.614 22.28L20.9473 16.9466C21.0687 16.8198 21.1639 16.6703 21.2273 16.5066C21.3607 16.182 21.3607 15.8179 21.2273 15.4933C21.1639 15.3296 21.0687 15.1801 20.9473 15.0533L15.614 9.71996C15.4897 9.59564 15.3421 9.49703 15.1797 9.42975C15.0172 9.36247 14.8431 9.32784 14.6673 9.32784C14.4915 9.32784 14.3174 9.36247 14.155 9.42975C13.9926 9.49703 13.845 9.59564 13.7207 9.71996C13.5963 9.84428 13.4977 9.99186 13.4304 10.1543C13.3632 10.3167 13.3285 10.4908 13.3285 10.6666C13.3285 10.8424 13.3632 11.0165 13.4304 11.179C13.4977 11.3414 13.5963 11.489 13.7207 11.6133L16.7873 14.6666H6.66732C6.3137 14.6666 5.97456 14.8071 5.72451 15.0572C5.47446 15.3072 5.33398 15.6463 5.33398 16ZM22.6673 2.66663H9.33398C8.27312 2.66663 7.2557 3.08805 6.50556 3.8382C5.75541 4.58834 5.33398 5.60576 5.33398 6.66663V10.6666C5.33398 11.0202 5.47446 11.3594 5.72451 11.6094C5.97456 11.8595 6.3137 12 6.66732 12C7.02094 12 7.36008 11.8595 7.61013 11.6094C7.86017 11.3594 8.00065 11.0202 8.00065 10.6666V6.66663C8.00065 6.313 8.14113 5.97387 8.39118 5.72382C8.64122 5.47377 8.98036 5.33329 9.33398 5.33329H22.6673C23.0209 5.33329 23.3601 5.47377 23.6101 5.72382C23.8602 5.97387 24.0007 6.313 24.0007 6.66663V25.3333C24.0007 25.6869 23.8602 26.0261 23.6101 26.2761C23.3601 26.5262 23.0209 26.6666 22.6673 26.6666H9.33398C8.98036 26.6666 8.64122 26.5262 8.39118 26.2761C8.14113 26.0261 8.00065 25.6869 8.00065 25.3333V21.3333C8.00065 20.9797 7.86017 20.6405 7.61013 20.3905C7.36008 20.1404 7.02094 20 6.66732 20C6.3137 20 5.97456 20.1404 5.72451 20.3905C5.47446 20.6405 5.33398 20.9797 5.33398 21.3333V25.3333C5.33398 26.3942 5.75541 27.4116 6.50556 28.1617C7.2557 28.9119 8.27312 29.3333 9.33398 29.3333H22.6673C23.7282 29.3333 24.7456 28.9119 25.4957 28.1617C26.2459 27.4116 26.6673 26.3942 26.6673 25.3333V6.66663C26.6673 5.60576 26.2459 4.58834 25.4957 3.8382C24.7456 3.08805 23.7282 2.66663 22.6673 2.66663Z" fill="black"/>
                  </svg>
                    <p className="popup-list-content">Log out</p>
                  </li>
                </div>
              </Popup>
        </div>
      </div>
     
      <>
      <div className="medium-devices navbar-mobiles">
        {onClickSearchIcon ? (
          <>
          <div className="navbar-mobile-contents-container">
              <button className="hamburger-icon-btn" onClick={()=>setOnclickSearchIcon(false)}>
                <FaArrowLeft/>
              </button>
              </div>
            <input
              type="search"
              placeholder="Search"
              value={searchInput}
              onChange={e=>setSearchValue(e.target.value)}
              className="search-input-mobile-devices"
            />
          </>
        ) : (
          <>
            <div className="navbar-mobile-contents-container">
              <button className="hamburger-icon-btn" onClick={()=>setOnClickHambergicon(!onClickHambergicon)}>
                {menuIcon}
              </button>
              <h3 className="navbar-logo-name">Platokart</h3>
            </div>
            <button className="search-icon-btn" onClick={()=>setOnclickSearchIcon(true)}>
              <IoIosSearch />
            </button>
          </>
        )}
      </div>
      {onClickHambergicon && (
        <div className="navbar-mobile-menus-container">
        <Link className="nav-link" to="/consultant/basic/profile">
              <p className="navbar-content-menu">My Profile</p>
            </Link>
            <Link className="nav-link" to="/community-panel">
              <p className="navbar-content-menu">Community Panel</p>
            </Link>
            <Link className="nav-link" to="/consultant/contactus">
              <p className="navbar-content-menu">Just Ask</p>
            </Link>
            <Link className="nav-link" to="">
              <p className="navbar-content-menu" onClick={handleLogout}>Logout</p>
            </Link>
        </div>
      )}
      </>
      
     
    </>
  );
};

export default ConsultantNavbar;
